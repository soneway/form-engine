(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{220:function(e,t,n){},331:function(e,t,n){"use strict";var a=n(220);n.n(a).a},337:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n(252),r=n.n(i),l=n(216),o=(n(20),n(28),n(14),n(26),n(54),n(203)),s=(n(217),n(202)),c=(n(21),n(218),n(219),n(96),n(25),n(10)),u=(n(55),n(27),n(246)),d=["label","text","number","textarea","radio","select","checkbox","boolean","region","object","array","nation","date","year","month","datetime","time"],m=n(247),f={name:"render-cell",functional:!0,props:{render:Function},render:function(e,t){return t.props.render(e,t.data.attrs)}},p=new a.default,h=(n(97),n(323));function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.map(function(e){var n=e.dep,a=Object(h.a)(e,["dep"]),i=n.key,r=n.opt,l=n.val,o=Object(s.getValueByPath)(t,i);if("function"==typeof r)return r(o,l)?a:void 0;switch(r){case"eq":if(o==l)return a;break;case"neq":if(o!=l)return a;break;case"ie":if(!o)return a;break;case"nie":if(o)return a;break;case"lt":if(+o<+l)return a;break;case"gt":if(+o>+l)return a;break;case"lte":if(+o<=+l)return a;break;case"gte":if(+o>=+l)return a;break;case"in":if("string"==typeof l&&(l=l.split(",")),l.filter(function(e){return e==o}).length)return a;break;case"reg":if(new RegExp(l).test(o))return a}}).filter(function(e){return e})}var y={date:"YYYY-MM-DD",year:"YYYY",month:"YYYY-MM",datetime:"YYYY-MM-DD HH:mm:ss",time:"HH:mm:ss"},v={name:"form-editor-item",components:{RenderCell:f},mixins:[u.default],inject:["formEditor"],props:{schema:Object,keyName:[String,Number],supKeyName:String,value:[Object,Array],pcaJson:Object},data:function(){return{expand:this.getExpand(),props:this.schema.props||{},curDepRules:[],depDisabled:void 0,depReadonly:void 0,depHidden:!1}},computed:{_class:function(){return["form-editor-item","".concat("form-editor-item","-").concat(this.type)]},_style:function(){return{display:this.depHidden?"none":null}},_objectClass:function(){return["".concat("form-editor-item","-object")]},_arrayClass:function(){return["".concat("form-editor-item","-array")]},itemProp:function(){return[this.supKeyName,this.keyName].filter(function(e){return void 0!==e}).join(".")},type:function(){var e=this.schema.type;return-1!==d.indexOf(e)?e:"text"},label:function(){var e=this.schema,t=this.keyName,n=e.label||t;if("number"!=typeof n)return n},placeholder:function(){var e=this.schema.placeholder,t=this.type,n=this.label;if(e)return e;return-1!==["select","nation"].indexOf(t)?"请选择".concat(n):"请输入".concat(n)},rules:function(){var e=this,t=this.schema.rules,n=void 0===t?[]:t,a=this.curDepRules,i=void 0===a?[]:a;if(!this.depHidden){var r=Object(c.a)(n).concat(Object(c.a)(i));if(r.length)return r.map(function(t){return t.required&&!t.message?Object(l.a)({},t,{message:"".concat(e.label,"不能为空")}):t.pattern?Object(l.a)({},t,{pattern:new RegExp(t.pattern)}):t})}},depRules:function(){return this.schema.depRules},depStyles:function(){return this.schema.depStyles},objectModel:function(){if("object"===this.type)return Object(m.getReactValue)(this.value,this.keyName,{})},arrayModel:function(){if("array"===this.type)return Object(m.getReactValue)(this.value,this.keyName,[])},fields:function(){return this.schema.fields},options:function(){return this.schema.options},maxlength:function(){return this.schema.maxlength||void 0},arraySchema:function(){var e=this.schema.expand;return{type:"object",fields:this.fields,expand:e}},isInput:function(){return["text","number","textarea"].includes(this.type)},isCheckList:function(){return["radio","checkbox"].includes(this.type)},isDatepicker:function(){return["date","year","month","datetime","time"].includes(this.type)},dateFormat:function(){return y[this.type]},readonly:function(){var e=this.schema.readonly,t=this.depReadonly;return void 0!==t?t:void 0!==e?e:this.formEditor.readonly},disabled:function(){var e=this.schema.disabled,t=this.depDisabled;return void 0!==t?t:void 0!==e?e:this.formEditor.disabled}},watch:{value:function(){this.dealDefault()}},mounted:function(){this.dealDefault(),this.initEvent()},methods:{initEvent:function(){p.$on("formEditor.value.change",this.depReact)},depReact:function(){this.initDepRules(),this.initDepStyles()},initDepRules:function(){var e=this.depRules,t=this.formEditor.value;e&&(this.curDepRules=b(e,t))},initDepStyles:function(){var e=this.depStyles,t=this.formEditor.value;e&&(this.depDisabled=b(e,t).some(function(e){return"disabled"===e.type}),this.depReadonly=b(e,t).some(function(e){return"readonly"===e.type}),this.depHidden=b(e,t).some(function(e){return"hidden"===e.type}))},dealDefault:function(){var e=this.value,t=this.keyName,n=this.schema;void 0===e[t]&&this.$set(e,t,n.default)},getExpand:function(){var e=this.schema.expand;return void 0===e||e},onToggleClick:function(){this.expand=!this.expand},onItemDeleteClick:function(e){this.arrayModel.splice(e,1),this.$forceUpdate()},onItemAddClick:function(){this.arrayModel.push({}),this.$forceUpdate()}}},g=n(0),k=Object(g.a)(v,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("gd-form-item",{class:e._class,style:e._style,attrs:{prop:e.itemProp,rules:e.rules,span:e.schema.span,"label-width":e.schema.labelWidth,"label-align":e.schema.labelAlign,label:e.label}},["function"==typeof e.schema.render?n("RenderCell",{attrs:{schema:e.schema,keyName:e.keyName,supKeyName:e.supKeyName,value:e.value,render:e.schema.render}}):[e.isInput?n("gd-input",e._b({attrs:{type:e.type,maxlength:e.maxlength,readonly:e.readonly,disabled:e.disabled,placeholder:e.placeholder},model:{value:e.value[e.keyName],callback:function(t){e.$set(e.value,e.keyName,t)},expression:"value[keyName]"}},"gd-input",e.props,!1)):e._e(),e._v(" "),e.isCheckList?n("gd-check-list",e._b({attrs:{multiple:"checkbox"===e.type,"item-type":e.type,readonly:e.readonly,disabled:e.disabled},model:{value:e.value[e.keyName],callback:function(t){e.$set(e.value,e.keyName,t)},expression:"value[keyName]"}},"gd-check-list",e.props,!1),e._l(e.options,function(e,t){return n("gd-check-item",{key:t,attrs:{value:e.value,label:e.label}})}),1):e._e(),e._v(" "),"select"===e.type?n("gd-select",e._b({attrs:{readonly:e.readonly,disabled:e.disabled,placeholder:e.placeholder,"data-source":e.options},model:{value:e.value[e.keyName],callback:function(t){e.$set(e.value,e.keyName,t)},expression:"value[keyName]"}},"gd-select",e.props,!1)):e._e(),e._v(" "),"boolean"===e.type?n("gd-checkbox",e._b({attrs:{readonly:e.readonly,disabled:e.disabled},model:{value:e.value[e.keyName],callback:function(t){e.$set(e.value,e.keyName,t)},expression:"value[keyName]"}},"gd-checkbox",e.props,!1)):e._e(),e._v(" "),"region"===e.type?n("gd-region-picker",e._b({attrs:{readonly:e.readonly,"pca-json":e.pcaJson,disabled:e.disabled},model:{value:e.value[e.keyName],callback:function(t){e.$set(e.value,e.keyName,t)},expression:"value[keyName]"}},"gd-region-picker",e.props,!1)):e._e(),e._v(" "),"object"===e.type?n("div",{staticClass:"object-wrapper",class:{expand:this.expand}},[n("gd-icon",{staticClass:"object-toggle-icon",attrs:{icon:"arrow-down"},on:{click:e.onToggleClick}}),e._v(" "),e._l(e.fields,function(t,a){return n("form-editor-item",{key:a,class:e._objectClass,attrs:{"pca-json":t.pcaJson||e.pcaJson,schema:t,"sup-key-name":e.itemProp,"key-name":a},model:{value:e.objectModel,callback:function(t){e.objectModel=t},expression:"objectModel"}})})],2):e._e(),e._v(" "),"array"===e.type?n("div",{staticClass:"array-wrapper"},[e._l(e.arrayModel,function(t,a){return n("form-editor-item",{key:a,class:e._arrayClass,attrs:{"pca-json":e.pcaJson,schema:e.arraySchema,"sup-key-name":e.itemProp,"key-name":a},model:{value:e.arrayModel,callback:function(t){e.arrayModel=t},expression:"arrayModel"}},[n("gd-icon",{staticClass:"array-delete-icon",attrs:{title:"删除项",icon:"close-circle"},on:{click:function(t){return e.onItemDeleteClick(a)}}})],1)}),e._v(" "),n("gd-icon",{staticClass:"add-icon",attrs:{icon:"plus-circle"},on:{click:e.onItemAddClick}},[e._v("添加项\n      ")])],2):e._e(),e._v(" "),"nation"===e.type?n("gd-select",e._b({attrs:{type:"nation",readonly:e.readonly,disabled:e.disabled,placeholder:e.placeholder},model:{value:e.value[e.keyName],callback:function(t){e.$set(e.value,e.keyName,t)},expression:"value[keyName]"}},"gd-select",e.props,!1)):e._e(),e._v(" "),e.isDatepicker?n("gd-datepicker",e._b({attrs:{type:e.type,"value-type":e.schema.valueType||"format",format:e.schema.format||e.dateFormat,range:e.schema.range,readonly:e.readonly,disabled:e.disabled},model:{value:e.value[e.keyName],callback:function(t){e.$set(e.value,e.keyName,t)},expression:"value[keyName]"}},"gd-datepicker",e.props,!1)):e._e()],e._v(" "),e._t("default")],2)},[],!1,null,null,null).exports;k.install=function(e){e.component(k.name,k)};var _=k,x={name:"form-editor",components:{FormEditorItem:_},provide:function(){return{formEditor:this}},props:{schema:{type:Object,default:function(){return{}}},value:{type:Object,default:function(){return{}}},size:String,activeKey:String,disabled:Boolean,readonly:Boolean,colcount:Number,pcaJson:{type:Object,default:function(){return{}}},labelWidth:String,labelAlign:String,gutter:Number},computed:{_class:function(){var e;return["form-editor",(e={},Object(o.a)(e,"".concat("form-editor","-").concat(this.size),this.size),Object(o.a)(e,"".concat("form-editor","-readonly"),this.readonly),Object(o.a)(e,"".concat("form-editor","-disabled"),this.disabled),e)]}},watch:{value:{handler:function(){p.$emit("formEditor.value.change")},deep:!0}},methods:{validate:function(e,t){var n=this;return new Promise(function(a){n.$refs.form.validate(function(i,r){var l=Object(s.deepCopy)(n.value);i?"function"==typeof e&&e(l,r):"function"==typeof t&&t(l,r),a(i)})})},getItemClass:function(e){return{active:e===this.activeKey}},onItemClick:function(e){this.$emit("itemclick",e)}}},C=Object(g.a)(x,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("gd-form",{ref:"form",class:e._class,attrs:{model:e.value,size:e.size,"label-width":e.labelWidth,"label-align":e.labelAlign,gutter:e.gutter,colcount:e.colcount}},e._l(e.schema,function(t,a){return n("FormEditorItem",{key:a,class:e.getItemClass(a),attrs:{"pca-json":t.pcaJson||e.pcaJson,schema:t,value:e.value,"key-name":a},nativeOn:{click:function(t){return e.onItemClick({keyName:a})}}},[e._t("item",null,{keyName:a,schema:t})],2)}),1)},[],!1,null,null,null).exports;C.install=function(e){e.component(C.name,C)};var E=C,j=n(248),N=n.n(j),O={name:"form-editor-draggable",components:{FormEditorItem:_,VueDraggable:N.a},provide:function(){return{formEditor:this}},props:{schema:{type:Object,default:function(){return{}}},value:{type:Object,default:function(){return{}}},size:String,activeKey:String,disabled:Boolean,readonly:Boolean,colcount:Number,pcaJson:{type:Object,default:function(){return{}}},labelWidth:String,labelAlign:String,gutter:Number},data:function(){return{keys:this.getKeysBySchema()}},computed:{_class:function(){return["form-editor",Object(o.a)({},"".concat("form-editor","-").concat(this.size),this.size)]},_draggableClass:function(){return["".concat("form-editor","-draggable")]}},watch:{schema:function(){this.keys=this.getKeysBySchema()},value:{handler:function(e){p.$emit("formEditor.value.change",e)},deep:!0}},methods:{getKeysBySchema:function(){var e=this.schema;return Object.keys(e).map(function(t){return{keyName:t,type:e[t].type}})},validate:function(e,t){var n=this;return new Promise(function(a){n.$refs.form.validate(function(i,r){var l=Object(s.deepCopy)(n.value);i?"function"==typeof e&&e(l,r):"function"==typeof t&&t(l,r),a(i)})})},onFieldSort:function(e){var t=e.added;if(t){var n=t.element,a=n.type,i=n.keyName;this.$emit("fieldadd",a,i)}this.$emit("fieldsort",this.keys)},getItemClass:function(e){return{active:e===this.activeKey}},onItemClick:function(e){this.$emit("itemclick",e)}}},$=Object(g.a)(O,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("gd-form",{ref:"form",class:e._class,attrs:{model:e.value,size:e.size,"label-width":e.labelWidth,"label-align":e.labelAlign,gutter:e.gutter,colcount:e.colcount}},[n("VueDraggable",{class:e._draggableClass,attrs:{group:"form"},on:{change:e.onFieldSort},model:{value:e.keys,callback:function(t){e.keys=t},expression:"keys"}},e._l(e.schema,function(t,a){return n("FormEditorItem",{key:a,class:e.getItemClass(a),attrs:{"pca-json":t.pcaJson||e.pcaJson,schema:t,value:e.value,"key-name":a},nativeOn:{click:function(t){return e.onItemClick({keyName:a})}}},[e._t("item",null,{keyName:a,schema:t})],2)}),1)],1)},[],!1,null,null,null).exports;$.install=function(e){e.component($.name,$)};var w=$,R=n(249),I={label:"标题",text:"文本",number:"数字",textarea:"长文本",radio:"单选",select:"选择",checkbox:"复选",boolean:"是否",region:"地区",object:"对象",array:"数组",nation:"民族",date:"日期",year:"年份",month:"月份",datetime:"日期时间",time:"时间"},D=(n(325),n(326),{phone:{name:"手机",regex:"^([1][3,4,5,6,7,8,9])\\d{9}$"},tel:{name:"固话",regex:"\\d{3}-\\d{8}|\\d{4}-\\d{7}"},email:{name:"邮箱",regex:"^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$"},url:{name:"链接",regex:"[a-zA-z]+://[^\\s]*"},idCard:{name:"身份证",regex:"(^\\d{8}(0\\d|10|11|12)([0-2]\\d|30|31)\\d{3}$)|(^\\d{6}(18|19|20)\\d{2}(0\\d|10|11|12)([0-2]\\d|30|31)\\d{3}(\\d|X|x)$)"},chinese:{name:"中文",regex:"[一-龥]"},zipCode:{name:"邮编",regex:"^(0[1-7]|1[0-356]|2[0-7]|3[0-6]|4[0-7]|5[1-7]|6[1-7]|7[0-5]|8[013-6])\\d{4}$"}}),S={number:"number",checkbox:"array",boolean:"boolean",region:"array",object:"object",array:"array"},F=(n(327),n(328),n(250),n(329),{name:"json-editor",components:{CodeMirror:n(330).codemirror},props:{value:String,options:{type:Object,default:function(){return{tabSize:2,mode:{name:"javascript",json:!0},lineNumbers:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]}}}},data:function(){return{curValue:this.value}},watch:{value:function(e){this.curValue=e},curValue:function(e){this.$emit("input",e)}}}),V=Object(g.a)(F,function(){var e=this,t=e.$createElement;return(e._self._c||t)("CodeMirror",{attrs:{options:e.options},model:{value:e.curValue,callback:function(t){e.curValue=t},expression:"curValue"}})},[],!1,null,null,null).exports;V.install=function(e){e.component(V.name,V)};var M=V,J={name:"field-config",components:{FormEditor:E,JsonEditor:M},props:{config:Object,fieldName:String},data:function(){return{required:this.getRule("required"),pattern:this.getRule("pattern"),max:this.getRule("max"),min:this.getRule("min"),len:this.getRule("len"),code:JSON.stringify(this.config.fields,null,"\t"),regexes:D}},computed:{_class:function(){return["field-config"]},_formClass:function(){return["".concat("field-config","-form")]},title:function(){return this.config.label||this.fieldName},isDefaultEnable:function(){return!this.typeInArray(["label"])},isPlaceholderEnable:function(){return!this.typeInArray(["object","array","checkbox","radio","boolean","region","label"])},isOptionsEnable:function(){return this.typeInArray(["radio","checkbox","select"])},isDatepicker:function(){return this.typeInArray(["date","year","month","datetime","time"])},isMaxlengthEnable:function(){return this.typeInArray(["textarea","text"])},isRulesEnable:function(){return!this.typeInArray(["object","array","label"])},isFieldsCodeEnable:function(){return this.typeInArray(["object","array"])},configSchema:function(){var e={label:{label:"标签名称"},labelAlign:{type:"radio",label:"标签对齐",options:[{label:"左对齐",value:"left"},{label:"居中",value:"center"},{label:"右对齐",value:"right"}]},span:{type:"radio",label:"显示宽度",options:[{label:"100%",value:12},{label:"3/4",value:9},{label:"2/3",value:8},{label:"1/2",value:6},{label:"1/3",value:4},{label:"1/4",value:3}]}};return this.isDefaultEnable&&(e.default={type:"text",label:"默认值"}),this.isPlaceholderEnable&&(e.placeholder={type:"text",label:"占位符"}),this.isOptionsEnable&&(e.options={type:"array",label:"选项列表",fields:{value:{type:"text",label:"选项值",rules:[{type:"string",required:!0}]},label:{type:"text",label:"选项名称"}}}),this.isDatepicker&&(e.range={type:"boolean",label:"是否选择范围"}),this.isMaxlengthEnable&&(e.maxlength={type:"number",label:"最大长度",rules:[{type:"number",min:1,message:"最大长度应为正整数"}]}),e},patternEnable:function(){return!!this.pattern.pattern},maxEnable:function(){return!!this.max.max},minEnable:function(){return!!this.min.min},lenEnable:function(){return!!this.len.len},checkedCommonRuleKeys:function(){var e=this.config.rules;return(void 0===e?[]:e).filter(function(e){return e._key}).map(function(e){return e._key})}},watch:{required:{deep:!0,handler:function(e){this.onChange("required",e.required)}},pattern:{deep:!0,handler:function(e){this.onChange("pattern",e.pattern)}},max:{deep:!0,handler:function(e){this.onChange("max",e.max)}},min:{deep:!0,handler:function(e){this.onChange("min",e.min)}},len:{deep:!0,handler:function(e){this.onChange("len",e.len)}},code:function(e){this.config.fields=Object(R.a)(e)},"value.range":{handler:function(e){var t=this;if(this.isDatepicker){var n=this.config.rules;(void 0===n?[]:n).forEach(function(n){n.type=e?"array":t.getRuleType()})}}}},methods:{typeInArray:function(e){return e.includes(this.config.type)},getRuleType:function(){return S[this.config.type]||"string"},getNoKeyRules:function(){var e=this.config.rules;return(void 0===e?[]:e).filter(function(e){return!e._key})},getRule:function(e){var t={type:this.getRuleType()};return this.getNoKeyRules().find(function(t){return void 0!==t[e]})||t},onChange:function(e,t){var n=this.config.rules,a=void 0===n?[]:n,i=a.findIndex(function(t){return!t._key&&void 0!==t[e]});if(t){if(-1===i){var r=this[e];this.isDatepicker&&(r.type=this.config.range?"array":this.getRuleType()),a.push(r)}}else a.splice(i,1)},onCommonRuleChange:function(e){var t=this,n=this.getNoKeyRules(),a=e.map(function(e){var n=D[e];return{_key:e,type:t.getRuleType(),pattern:n.regex,message:"".concat(n.name,"格式不正确")}});this.config.rules=n.concat(a)}}},q=Object(g.a)(J,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e._class},[n("h3",[e._v(e._s(e.title)+" - 配置")]),e._v(" "),n("FormEditor",{class:e._formClass,attrs:{schema:e.configSchema,value:e.config}}),e._v(" "),e.isRulesEnable?[n("h3",[e._v("常用校验规则")]),e._v(" "),n("gd-check-list",{attrs:{"item-type":"checkbox",multiple:"",value:e.checkedCommonRuleKeys},on:{change:e.onCommonRuleChange}},e._l(e.regexes,function(e,t){return n("gd-check-item",{key:t,attrs:{label:e.name,value:t}})}),1),e._v(" "),n("h3",[e._v("校验规则")]),e._v(" "),n("div",{staticClass:"rule-item"},[n("gd-checkbox",{model:{value:e.required.required,callback:function(t){e.$set(e.required,"required",t)},expression:"required.required"}},[e._v("必填\n      ")]),e._v(" "),n("gd-input",{attrs:{disabled:!e.required.required,placeholder:"请输入校验出错提示信息"},model:{value:e.required.message,callback:function(t){e.$set(e.required,"message",t)},expression:"required.message"}})],1),e._v(" "),n("div",{staticClass:"rule-item"},[n("gd-checkbox",{attrs:{disabled:!e.patternEnable,readonly:"",value:e.patternEnable}},[e._v("正则\n      ")]),e._v(" "),n("gd-input",{attrs:{placeholder:"请输入正则, 如: ^[0-9]*$"},model:{value:e.pattern.pattern,callback:function(t){e.$set(e.pattern,"pattern",t)},expression:"pattern.pattern"}}),e._v(" "),n("gd-input",{attrs:{disabled:!e.patternEnable,placeholder:"请输入校验出错提示信息"},model:{value:e.pattern.message,callback:function(t){e.$set(e.pattern,"message",t)},expression:"pattern.message"}})],1),e._v(" "),n("div",{staticClass:"rule-item"},[n("gd-checkbox",{attrs:{disabled:!e.minEnable,readonly:"",value:e.minEnable}},[e._v("最小\n      ")]),e._v(" "),n("gd-input",{attrs:{type:"number",placeholder:"请输入最小值"},model:{value:e.min.min,callback:function(t){e.$set(e.min,"min",t)},expression:"min.min"}}),e._v(" "),n("gd-input",{attrs:{disabled:!e.minEnable,placeholder:"请输入校验出错提示信息"},model:{value:e.min.message,callback:function(t){e.$set(e.min,"message",t)},expression:"min.message"}})],1),e._v(" "),n("div",{staticClass:"rule-item"},[n("gd-checkbox",{attrs:{disabled:!e.maxEnable,readonly:"",value:e.maxEnable}},[e._v("最大\n      ")]),e._v(" "),n("gd-input",{attrs:{type:"number",placeholder:"请输入最大值"},model:{value:e.max.max,callback:function(t){e.$set(e.max,"max",t)},expression:"max.max"}}),e._v(" "),n("gd-input",{attrs:{disabled:!e.maxEnable,placeholder:"请输入校验出错提示信息"},model:{value:e.max.message,callback:function(t){e.$set(e.max,"message",t)},expression:"max.message"}})],1),e._v(" "),n("div",{staticClass:"rule-item"},[n("gd-checkbox",{attrs:{disabled:!e.lenEnable,readonly:"",value:e.lenEnable}},[e._v("长度\n      ")]),e._v(" "),n("gd-input",{attrs:{type:"number",placeholder:"请输入长度"},model:{value:e.len.len,callback:function(t){e.$set(e.len,"len",t)},expression:"len.len"}}),e._v(" "),n("gd-input",{attrs:{disabled:!e.lenEnable,placeholder:"请输入校验出错提示信息"},model:{value:e.len.message,callback:function(t){e.$set(e.len,"message",t)},expression:"len.message"}})],1)]:e._e(),e._v(" "),e.isFieldsCodeEnable?[n("h3",[e._v("对象/数组代码")]),e._v(" "),n("div",{staticClass:"form-schemer-code"},[n("JsonEditor",{model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1)]:e._e()],2)},[],!1,null,null,null).exports,K={name:"form-schemer",components:{FormEditorDraggable:w,FieldConfig:q,JsonEditor:M,VueDraggable:N.a},props:{value:Object,pcaJson:Object},data:function(){var e=this.value||{};return{curValue:e,keyIndex:1,types:d,typeMap:I,fieldName:"",pending:!1,code:JSON.stringify(e,null,"\t"),tabIndex:0,typeGroup:{name:"form",pull:"clone",put:"false"}}},computed:{_class:function(){return["form-schemer"]},_visualClass:function(){return["".concat("form-schemer","-visual")]},_workClass:function(){return["".concat("form-schemer","-work")]},_previewClass:function(){return["".concat("form-schemer","-preview")]},_configClass:function(){return["".concat("form-schemer","-config")]},_typeClass:function(){return["".concat("form-schemer","-type")]},_toolsClass:function(){return["".concat("form-schemer","-tools")]},fieldConfig:function(){return this.curValue[this.fieldName]}},watch:{value:function(e){e&&(this.curValue=e)},curValue:function(e){this.$emit("input",e)},tabIndex:function(e){1===e&&(this.code=JSON.stringify(this.curValue,null,"\t"))},code:function(e){this.curValue=Object(R.a)(e)},fieldConfig:function(){var e=this;this.pending=!0,this.$nextTick(function(){e.pending=!1})}},methods:{onTypeClick:function(e){var t=e.currentTarget.dataset.type;this.addField(t)},addField:function(e,t){t=t||this.getKeyName(e);var n=Object(o.a)({},t,{type:e,rules:[]});["array","object"].includes(e)&&(n[t].fields={}),this.curValue=Object(l.a)({},this.curValue,n),this.onFieldConfig({keyName:t})},getKeyName:function(e){for(var t=this.keyIndex,n=this.curValue;n["".concat(e).concat(t)];)t=++this.keyIndex;return"".concat(e).concat(t)},onFieldDelete:function(e){var t=e.keyName;delete this.curValue[t],this.curValue=Object(l.a)({},this.curValue)},onFieldConfig:function(e){var t=e.keyName;this.fieldName=t},onFieldSort:function(e){var t=this,n={};e.forEach(function(e){n[e.keyName]=t.curValue[e.keyName]}),this.curValue=n},onItemClick:function(e){this.onFieldConfig(e)},cloneField:function(e){return{type:e,keyName:this.getKeyName(e)}},onValidateClick:function(){var e=this;this.$refs.formEditor.validate(function(t){e.$toast.success("校验成功"),console.log("校验成功",t)},function(t){e.$toast.error("校验失败"),console.log("校验失败",t)})}}},A=Object(g.a)(K,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e._class},[n("gd-tabs",{model:{value:e.tabIndex,callback:function(t){e.tabIndex=t},expression:"tabIndex"}},[n("gd-tabs-pane",{attrs:{label:"可视化"}},[n("div",{class:e._visualClass},[n("VueDraggable",{class:e._typeClass,attrs:{group:e.typeGroup,value:e.types,sort:!1,clone:e.cloneField}},e._l(e.types,function(t){return n("a",{key:t,class:"form-icon-"+t+" type-item",attrs:{"data-type":t},on:{click:e.onTypeClick}},[e._v(e._s(e.typeMap[t])+"\n          ")])}),0),e._v(" "),n("div",{class:e._workClass},[n("div",{class:e._previewClass},[n("FormEditorDraggable",{ref:"formEditor",attrs:{"pca-json":e.pcaJson,"active-key":e.fieldName,schema:e.curValue},on:{fieldsort:e.onFieldSort,fieldadd:e.addField,itemclick:e.onItemClick},scopedSlots:e._u([{key:"item",fn:function(t){return n("div",{class:e._toolsClass},[n("gd-confirm-poptip",{attrs:{placement:"left"},on:{confirm:function(n){return e.onFieldDelete(t)}}},[n("gd-icon",{staticClass:"field-delete-icon",attrs:{icon:"delete",title:"删除"}})],1)],1)}}])}),e._v(" "),Object.keys(e.curValue).length?[n("gd-button",{on:{click:e.onValidateClick}},[e._v("模拟校验")])]:e._e()],2),e._v(" "),n("div",{class:e._configClass},[!e.pending&&e.fieldConfig?n("FieldConfig",{attrs:{config:e.fieldConfig,"field-name":e.fieldName}}):e._e()],1)])],1)]),e._v(" "),n("gd-tabs-pane",{attrs:{label:"代码"}},[n("JsonEditor",{model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1)],1)],1)},[],!1,null,null,null).exports;A.install=function(e){e.component(A.name,A)};var Y={FormEditor:E,FormEditorDraggable:w,FormEditorItem:_,FormSchemer:A,JsonEditor:M};function z(e){Object.keys(Y).forEach(function(t){e.component(t,Y[t])})}"undefined"!=typeof window&&window.Vue&&z(window.Vue);var T=Object(l.a)({install:z},Y);a.default.use(r.a),a.default.use(T);var P={data:function(){return{codeExpand:!1}},computed:{_class:function(){return{expanded:this.codeExpand}}},methods:{onToggleClick:function(){this.codeExpand=!this.codeExpand}}},B=(n(331),Object(g.a)(P,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"clinet-code",class:this._class},[t("div",{staticClass:"slot-wrapper"},[this._t("default")],2),this._v(" "),t("a",{staticClass:"toggle-code",on:{click:this.onToggleClick}})])},[],!1,null,null,null));t.default=B.exports}}]);